Port from
https://github.com/angular/angular/commit/f6cc57368768e0c2f47c6646620c4cff73e5d5a7
